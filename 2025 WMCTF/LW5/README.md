## LW5

+ Difficulty：Hard
+ Solved：0

<br/>

## Description

LW:5

<br/>

## Solution

类似LW3，但这一次可以自己输入5个error作为随机选取的值，而对于输入的error会做check，主要需要满足：

+ 模$p$意义下互不相同
+ 无法直接线性映射到一个均较小的值

此外对参数$n$进行了略微降低，从64改到了56，依然是要攻破这个LWE的私钥$\mathbf{s}$从而拿到flag。

其实出完这个题目的时候很担心有奇怪的逃课的姿势，不过仔仔细细想了一圈也没有太想到，虽然最终没有出现什么非预期，但是可能会被偷鸡的隐患隐隐约约感觉还是存在。

> 毕竟check实在长得有点奇怪XD

言归正传，聊回这个题目的思路。如果完全理解了LW3的话肯定很自然的就会类似想到：由于同样限制了不能直接将五元的错误集合线性映射到各分量都较小的情况，因此继续采用转成$4m$个01变量的方式，然后去规约$4m+1$的格。然而$4m+1$有361维，虽然不能说很大但绝对也不算小，并且由于格的维数上去了而约束数量没有变，因此Gap缩小的很快，极端一点甚至没有办法保证目标向量还是最短向量，更不用说规约出来了。

此时需要一个tradeoff的思想，我们可以想到直接线性映射的情况大概是$m$个$\sqrt{q}$数量级的变量，而二进制展开则是$4m$个01变量，那么有没有办法构造一个错误集合，使得其转化后**变量数量增多的不多，而且变量的数量级也不大**？

这当然是可以做到而且可以轻松做到的，回顾这两种方法其实能找到一种共性：都是找到一个基$g$，使得其能够用较小的系数线性表示出所有可能的error。比如对于直接的线性映射，可以写为：

$$
X_{5,1}\mathbf{g}_{1,1} + t\cdot \mathbf{1} = \mathbf{e}_{5,1}
$$
这里的$X$矩阵实际也就是$\mathbf{e}$经线性映射能达到的最小的$\mathbf{e}'$。

而对于二进制展开(不利用仿射子空间降维)，可以写为：
$$
\begin{cases}
X_{5,5}\mathbf{g}_{5,1} + t\cdot \mathbf{1} = \mathbf{e}_{5,1} \\
t = 0
\end{cases}
$$
此时$X$矩阵即为每一行有且仅有一个1的01矩阵。

而利用仿射子空间降维后的二进制展开则可以写为：
$$
\begin{cases}
X_{5,4}\mathbf{g}_{4,1} + t\cdot \mathbf{1} = \mathbf{e}_{5,1} \\
t = e_1
\end{cases}
$$

此时$X$的每一行分别为$(0,0,0,0),(1,0,0,0),(0,1,0,0),(0,0,1,0),(0,0,0,1)$。

所以，当线性映射界不够而二进制展开格维数又过大时，可以考虑找一组相对来说维数较小、对应矩阵$X$分量值也较小的基$\mathbf{g}$，从而尽量辅助最后的规约。并且本题由于$\mathbf{e}$能自定义输入，因此只需要自行构造一个小$X$矩阵，并随机生成$\mathbf{g}$直至满足题目对于$\mathbf{e}$的其余限制即可。

此后的展开过程和LW3就完全一样了，最后同样用了blaster来帮助找到短向量。