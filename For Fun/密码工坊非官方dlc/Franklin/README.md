## Franklin

+ Difficulty：Hard

## Solution

enc1和enc2联立可以消去y，此时得到的多项式记为$f$，则$f$与enc3表示的多项式$g$有公共根$m$，因此考虑gcd求解m。

问题在于$g$的度过大，所以需要先在模$f$的商环下降低他的度，之后再用gcd就可以求出m，由于度还是有好几万所以用HGCD。

> 之所以可以在商环下求解道理也很简单，由于有：
> $$
> g(m) = 0
> $$
>
> $$
> f(m) = 0
> $$
>
> 所以对于任意如下的$F(x)$来说：
> $$
> F(x) = g(x) - u(x)f(x)
> $$
> 都有：
> $$
> F(m) = g(m) - u(m)f(m) = 0
> $$

exp：

```python
from Crypto.Util.number import *

n = 88788175298465513261662868467652974114242366844342642415894812705741806415662821340452737186626127979613330126630251946981599456759463409775404662175575113904655955382099962219689405789906239700746970818434575856774643659290185390960087954228178430162070177988675527502551806901834765586286653422380753610667
e = 14217411865815639661
enc1 = 57564911814909361342018380100563751206320795917755942045089406476558273620162500977707720051072876656536489595324014422303060206226108425697233573404358017976677756269091434180377993027098755855818865024130833524142316876299135689166477957639463036848828892498076048317210811872346500691268749549749231344124
enc2 = 28690817176043891189508173123314547784815477391444813913373239514479675196456422066111357443251261091188437244031909966729467428913714838460265291927594285866882245205955276643377341606962161610533371172176870727466969036166765143372607252040019241701440363689177510821448903507984910100605526113573418826029
enc3 = 31299054684357436306569064937389570902953156600264682126360780641391235544775475155676575201708422170764491460584222467692806153066438582533740776369690752869146507775246199203512079012598198823980867371995511852791060678257705155460693356621332652138139425204651195857959958587091232728607469359494378833571

PR.<x> = PolynomialRing(Zmod(n))
f1 = x^77797 + (2*x-enc1)^99979 - enc2
PRq = PR.quo(f1,'z')
z = PRq.gen()
f2 = PRq(z^e - enc3)
f2 = f2.lift()


#part2 HGCD
def HGCD(a, b):
    if 2 * b.degree() <= a.degree() or a.degree() == 1:
        return 1, 0, 0, 1
    m = a.degree() // 2
    a_top, a_bot = a.quo_rem(x^m)
    b_top, b_bot = b.quo_rem(x^m)
    R00, R01, R10, R11 = HGCD(a_top, b_top)
    c = R00 * a + R01 * b
    d = R10 * a + R11 * b
    q, e = c.quo_rem(d)
    d_top, d_bot = d.quo_rem(x^(m // 2))
    e_top, e_bot = e.quo_rem(x^(m // 2))
    S00, S01, S10, S11 = HGCD(d_top, e_top)
    RET00 = S01 * R00 + (S00 - q * S01) * R10
    RET01 = S01 * R01 + (S00 - q * S01) * R11
    RET10 = S11 * R00 + (S10 - q * S11) * R10
    RET11 = S11 * R01 + (S10 - q * S11) * R11
    return RET00, RET01, RET10, RET11
    
def GCD(a, b):
    print(a.degree(), b.degree())
    q, r = a.quo_rem(b)
    if r == 0:
        return b
    R00, R01, R10, R11 = HGCD(a, b)
    c = R00 * a + R01 * b
    d = R10 * a + R11 * b
    if d == 0:
        return c.monic()
    q, r = c.quo_rem(d)
    if r == 0:
        return d
    return GCD(d, r)

res = GCD(f1,f2)

m = -res.monic().coefficients()[0]
flag = long_to_bytes(int(m))
print(flag)


#NSSCTF{Rem0Ve_y_4nD_C0mb1n3_HGCD_4nD_Euclid}
```

